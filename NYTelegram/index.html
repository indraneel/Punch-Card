<!DOCTYPE HTML>
<html>
    <head>
	<meta charset="utf-8">
	<title>Canvas Background through CSS</title>
	<style type="text/css" media="screen">

	    @font-face {
		font-family: "Telegram HPLHS";
		src:local("./Telegram HPLHS.ttf");
	    }

	    body {
		/*background-color: #e9d9c2;*/
		background-color: #FFFFFF;
		/*background-image: url(background.jpg) top left repeat-x;*/
		font-family: "Telegram HPLHS", serif;
	    }
	</style>
    </head>
    <body>
	<div style='font-family: "Telegram HPLHS"'> </div>
	<!-- <img id="telegram" src="./telegram.jpg" width="700" height="476" style="display:none" /> -->
	<canvas id="telegramcanvas"  width="700" height="476"></canvas>
	<script src="./jquery.min.js"></script>
	<script type="text/javascript" charset="utf-8">
	    $(document).ready(function() {
		/*apikey ="10a346e5d8ddbc7e536f1916cde1824d:18:67525807";
		var getStories = function(){
		query = "hackny";
		console.log(encodeURIComponent(":"));
		    dataString = "query="+query+"&api-key="+encodeURIComponent(apikey);
		    console.log(dataString); 
		    $.ajax({
			type: "GET",
			/*url: "http://api.nytimes.com/svc/search/v1/article",
			url: "https://dl.dropbox.com/u/117295/nytimes.py",
			dataType: "jsonp",
			jsonp:"callback",
			data:dataString,
			success: function() {
			    console.log("success");
			},
			error: function() {
			    console.log("failure");
			}
		    });
		}
		 */
		console.log({{date}});
		var canvas = document.getElementById("telegramcanvas");
		var context = canvas.getContext("2d");
		// var telegram = document.getElementById("telegram");
		var telegram = new Image();

      	telegram.onload = function() {
	        context.drawImage(telegram, 69, 50);
			context.drawImage(telegram,0,0);
			context.textBaseline = "top";
			//getStories();
			// context.fillText("A Secret Deal on Drones, Sealed in Blood", 58, 225);
			// tit0 = "{{tit0}}"
			// if (tit0.length > 31) {
			// 	tit0 = tit0.substring(0,27)+ "STOP"
			// }
			// tit1 = "{{tit1}}"
			// if (tit1.length > 31) {
			// 	tit1 = tit1.substring(0,27)+ "STOP"
			// }
			// tit2 = "{{tit2}}"
			// if (tit2.length > 31) {
			// 	tit2 = tit2.substring(0,27)+ "STOP"
			// }
			body = '{{body}}'
			body = body.split('.')[0]
			if (body.length > 31) {
				body1 = body.substring(0,31)
				body2 = body.substring(31, body.length)
			}

			body2 = body2.trim()
			len2 = body2.length
			if (len2 > 31) {
				body3 = body2.substring(31, len2)
				body2 = body2.substring(0,31)
			}
			if (body3.length > 31) {
				body3 = body3.substring(0,28) + "..."
			}

			context.font = '64px "Courier" mono';
			context.fillText("TELEGRAM", 210, 115)
			context.font = '32px "Courier" mono';
			context.fillText(body1, 58, 225);
			context.fillText(body2, 58, 275);
			context.fillText(body3, 58, 325);
      	};
      	telegram.src = './telegram.jpg'
	    });
	</script>
    </body>
</html>
